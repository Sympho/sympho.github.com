/* 
* The Parade
* description: A simple JS popup
* version: 1.0.0
* date: 2016-10-14
* url: fb.me/mieertha
* Copyright 2016 Azim Curt;
*/
!function(a,b,c,d){b.Parade=function a(c){if(!(this instanceof a))return new a(c);b.event=c.eventStop||b.event,event.preventDefault();var d=this;if(d.default={status:!1,eventStop:!1,html:!1,build:{},items:!1,gallery:!1,imageSrc:!1,imageTitle:!1,closeCover:!0,closeBtn:!0,closeBtnFix:!1,closeDelay:300,closeBtnText:"&times;",closeBtnTitle:"[ESC] to close",loadingText:"Loading...",customClass:""},d.options=d.default,"object"==typeof c)for(option in c)d.options.hasOwnProperty(option)&&(d.options[option]=c[option]);d.init()&&(d.options.status=d.open(),d.events())},Parade.prototype.init=function(){if(c.querySelector(".prd-container")&&c.body.removeChild(c.querySelector(".prd-container")),this.options.gallery!==!1){var a=this.options.items||"a",b=!1,d=this.options.gallery.querySelectorAll(a);this.options.items=[];for(var e=0,f=d.length;e<f;e++){var g={item:d[e],active:!1};this.closest(event.target,d[e])&&(g.active=!0,b=e),this.options.items.push(g)}if(b===!1)return!1}var h=document.createElement("div"),i=document.createElement("div"),j=document.createElement("div"),k=document.createElement("div"),l=document.createElement("button"),m=document.createElement("div");return m.setAttribute("class","prd-content"),l.setAttribute("class","prd-close"),l.setAttribute("title",this.options.closeBtnTitle),k.setAttribute("class","prd-inner"),j.setAttribute("class","prd-box"),i.setAttribute("class","prd-outer"),h.setAttribute("class","prd-container "+this.options.customClass),h.appendChild(i),i.appendChild(j),j.appendChild(k),this.options.closeBtnFix===!0&&this.options.closeBtn?i.appendChild(l):this.options.closeBtn&&k.appendChild(l),k.appendChild(m),l.innerHTML=this.options.closeBtnText,c.body.insertBefore(h,c.body.firstChild),this.options.build={container:h,outer:i,box:j,inner:k,close:l,content:m},this.options.imageSrc!==!1&&this.options.html===!1&&this.options.gallery===!1&&this.showImage(this.options.imageSrc,this.options.imageTitle),this.options.html!==!1&&this.html(this.options.html),this.options.gallery!==!1&&(this.options.build.content.classList.add("prd-gallery-content"),this.galleryBuildCtrl(b)),!0},Parade.prototype.bodyAction=function(a){var d=b.innerWidth||c.documentElement.clientWidth||c.body.clientWidth,e=d-this.options.build.container.clientWidth;"open"===a?(c.documentElement.classList.add("prd-body"),c.documentElement.style.marginRight=e+"px"):"close"===a&&(c.documentElement.classList.remove("prd-body"),c.documentElement.style.marginRight="0px")},Parade.prototype.showImage=function(a,b){var d=this;this.html('<span class="prd-loading">'+this.options.loadingText+"</span>");var e=c.createElement("img");e.setAttribute("src",a),e.onload=function(){e.style.display="block",e.style.maxWidth="100%",d.options.build.box.setAttribute("class","prd-box prd-image"),d.html(""),d.options.build.content.appendChild(e),"string"==typeof b&&""!=b&&(d.options.build.content.innerHTML+='<div class="prd-image-title">'+b+"</div>",e.alt=b)}},Parade.prototype.galleryBuildCtrl=function(a){if(this.options.imageSrc){var b=this.options.items[a].item.getAttribute(this.options.imageSrc);if(this.options.imageTitle)var d=this.options.items[a].item.getAttribute(this.options.imageTitle);else var d=this.options.items[a].item.getAttribute("title");this.showImage(b,d)}else this.showImage(this.options.items[a].item.href,this.options.items[a].item.title);var e=c.createElement("button"),f=c.createElement("button");e.innerHTML="←",f.innerHTML="→",e.title="[←] to previous",f.title="[→] to next",e.className="prd-prev",f.className="prd-next",this.options.ctrl={},this.options.ctrl.index=a,this.options.ctrl.prev=e,this.options.ctrl.next=f,this.options.build.outer.appendChild(e),this.options.build.outer.appendChild(f)},Parade.prototype.galleryCtrl=function(a){var b=this,c=!1;if("prev"===a&&b.options.ctrl.index>0?(b.options.ctrl.index=b.options.ctrl.index-1,c=!0):"next"===a&&b.options.ctrl.index<b.options.items.length-1&&(b.options.ctrl.index=b.options.ctrl.index+1,c=!0),c)if(b.options.imageSrc){var d=b.options.items[b.options.ctrl.index].item.getAttribute(b.options.imageSrc);if(b.options.imageTitle)var e=b.options.items[b.options.ctrl.index].item.getAttribute(b.options.imageTitle);else var e=b.options.items[b.options.ctrl.index].item.getAttribute("title");b.showImage(d,e)}else b.showImage(b.options.items[b.options.ctrl.index].item.href,b.options.items[b.options.ctrl.index].item.title)},Parade.prototype.open=function(){return this.bodyAction("open"),this.options.build.container.classList.add("prd-active"),!0},Parade.prototype.close=function(){var a=this;a.options.build.container.classList.remove("prd-active"),setTimeout(function(){a.bodyAction("close"),c.body.removeChild(a.options.build.container),a.options.status=!1},a.options.closeDelay)},Parade.prototype.html=function(a){this.options.build.content.innerHTML=a},Parade.prototype.closest=function(a,b){for(;a;){if(a===b)return!0;a=a.parentNode}},Parade.prototype.events=function(){var a=this;a.options.build.close.addEventListener("click",function(b){a.options.closeBtnFix===!1&&a.close()},!1),a.options.build.container.addEventListener("click",function(b){var c=!1;!a.closest(b.target,a.options.build.inner)&&a.options.closeCover?"object"==typeof a.options.ctrl&&a.closest(b.target,a.options.ctrl.prev)?a.galleryCtrl("prev"):"object"==typeof a.options.ctrl&&a.closest(b.target,a.options.ctrl.next)?a.galleryCtrl("next"):c=!0:"object"==typeof a.options.ctrl&&a.closest(b.target,a.options.build.content)&&a.galleryCtrl("next"),c&&a.close()},!1),c.onkeydown=function(c){c=c||b.event;var d=!1;d="key"in c?"Escape"==c.key||"Esc"==c.key:27==c.keyCode,d&&a.options.status&&a.options.closeCover&&a.close(),a.options.gallery!==!1&&37==c.keyCode?a.galleryCtrl("prev"):a.options.gallery!==!1&&39==c.keyCode&&a.galleryCtrl("next")}}}(this,window,window.document);